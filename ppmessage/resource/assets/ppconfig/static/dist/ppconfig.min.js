function $yvAjaxService(t,e,s,n){var o=function(t,e){return e=e||{},t="/ppconfig"+t,s({method:"POST",cache:!1,url:t,data:e})},a={NO_ERR:0};return{status:function(){var t="/status",e={};return o(t,e)},server:function(t){var e="/server";return o(e,t)},database:function(t){var e="/database";return o(e,t)},first:function(t){var e="/first",s=angular.copy(t);return s.user_password=sha1(s.user_password),o(e,s)},restart:function(t){var e="/restart",s=angular.copy(t);return s.user_password=sha1(s.user_password),o(e,s)},API_ERR:a}}function ConfigServerController(t,e,s){t.server={url:"http://"+t._config_status.ip+":8945",identicon_store:"/usr/local/opt/ppmessage/identicon",generic_store:"/usr/local/opt/ppmessage/generic",disable_submit:!1},t.hide=function(){e.hide()},t.cancel=function(){e.cancel()},t.answer=function(t){e.hide(t)},t.confirm=function(){t.server.disable_submit=!0,s.server(t.server).then(function(){e.hide("success")},function(){t.server.disable_submit=!1,console.log("server config failed")})}}function ConfigDatabaseController(t,e,s){var n={SQLITE:"SQLITE",MYSQL:"MYSQL",PGSQL:"PGSQL"};t.database={type:n.SQLITE,types:angular.copy(n),sqlite:{db_file_path:"/usr/local/var/db/sqlite/ppmessage.db"},mysql:{db_host:"127.0.0.1",db_port:"3306",db_user:"root",db_pass:"test",db_name:"ppmessage"},pgsql:{db_host:"127.0.0.1",db_port:"5432",db_user:"postgres",db_pass:"test",db_name:"ppmessage"},disable_submit:!1},t.hide=function(){e.hide()},t.cancel=function(){e.cancel()},t.answer=function(t){e.hide(t)},t.should_show_mysql=function(){return t.database.type==n.MYSQL},t.should_show_sqlite=function(){return t.database.type==n.SQLITE},t.should_show_pgsql=function(){return t.database.type==n.PGSQL},t.confirm=function(){t.database.disable_submit=!0,s.database(t.database).then(function(){e.hide("success")},function(){t.database.disable_submit=!1,console.log("database config failed")})}}function CreateFirstController(t,e,s){t.user={user_status:"OWNER_2",user_fullname:"Guijin Ding",user_email:"dingguijin@gmail.com",user_password:"x",team_name:"PPMessage",user_password_is_visible:!1,password_input_type:"password",disable_submit:!1},t.hide=function(){e.hide()},t.cancel=function(){e.cancel()},t.answer=function(t){e.hide(t)},t.confirm=function(){t.user.disable_submit=!0,s.first(t.user).then(function(){e.hide("success")},function(){t.user.disable_submit=!1,console.log("first user create failed")})},t.show_user_password=function(e){e?(t.user.user_password_is_visible=!0,t.user.password_input_type="text"):(t.user.user_password_is_visible=!1,t.user.password_input_type="password")}}function RestartController(t,e,s){t.user={user_password:"",user_password_is_visible:!1,password_input_type:"password",disable_submit:!1},t.hide=function(){e.hide()},t.cancel=function(){e.cancel()},t.answer=function(t){e.hide(t)},t.confirm=function(){t.user.disable_submit=!0,s.restart(t.user).then(function(){e.hide("success")},function(){t.user.disable_submit=!1})},t.pass=function(){e.hide("success")},t.show_user_password=function(e){e?(t.user.user_password_is_visible=!0,t.user.password_input_type="text"):(t.user.user_password_is_visible=!1,t.user.password_input_type="password")}}ConfigServerController.$inject=["$scope","$mdDialog","yvAjax"],ConfigDatabaseController.$inject=["$scope","$mdDialog","yvAjax"],CreateFirstController.$inject=["$scope","$mdDialog","yvAjax"],RestartController.$inject=["$scope","$mdDialog","yvAjax"],function(){window&&void 0===window.ppconfig&&(window.ppconfig={version:"0.0.0.2"})}(),function(){for(var t,e=function(){},s=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],n=s.length,o=window.console=window.console||{};n--;)t=s[n],o[t]||(o[t]=e)}(),angular.module("this_app.services",[]),angular.module("this_app",["ui.router","base64","ngRoute","ngMessages","ngAnimate","ngMaterial","this_app.constants","this_app.route","this_app.services"]).run(["$rootScope","$location","$timeout",function(t,e,s){window.PP}]),angular.module("this_app.constants",[]).constant("yvConstants",{TEMPLATE_PREFIX:"templates/",STATIC_PREFIX:"/ppconfig/static/"}),angular.module("this_app.route",[]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("app",{"abstract":!0,url:"/app",templateUrl:"templates/app.html",controller:"AppCtrl"}).state("app.config",{url:"/config",templateUrl:"templates/config.html",controller:"ConfigCtrl"}),e.otherwise("/app/config")}]),$yvAjaxService.$inject=["$state","$timeout","$http","yvConstants"],angular.module("this_app.services").factory("yvAjax",$yvAjaxService),angular.module("this_app").controller("AppCtrl",["$window","$scope","$rootScope","$location","$state","$timeout","$mdToast","yvAjax",function(t,e,s,n,o,a,i,r){e.thisYear=(new Date).getUTCFullYear(),e.ppmessage=function(){window.open("https://ppmessage.com")},e.toast_string=function(t){a(function(){i.show(i.simple().textContent(_str).position("top right").hideDelay(3e3))})}}]),angular.module("this_app").controller("ConfigCtrl",["$scope","$state","$stateParams","$timeout","$window","$mdDialog","yvAjax",function(t,e,s,n,o,a,i){var r={NONE:0,SERVER:1,DATABASE:2,FIRST:3,RESTART:4};t._config_status={status:r.NONE,ip:"127.0.0.1"},t.get_server_status=function(){return t._config_status.status==r.NONE?"N/A":"OK"},t.get_database_status=function(){return t._config_status.status<r.DATABASE?"N/A":"OK"},t.get_first_status=function(){return t._config_status.status>=r.FIRST?"OK":"N/A"},t.should_disable_config_server=function(){return t._config_status.status!=r.NONE},t.should_disable_config_database=function(){return t._config_status.status!=r.SERVER},t.should_disable_create_first=function(){return t._config_status.status!=r.DATABASE},t.should_disable_restart=function(){return t._config_status.status!=r.FIRST},t.config_server=function(e){a.show({scope:t.$new(),controller:ConfigServerController,templateUrl:"templates/dialog/config-server.tmpl.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(e){t._init_config_status()},function(){})},t.config_database=function(e){a.show({controller:ConfigDatabaseController,templateUrl:"templates/dialog/config-database.tmpl.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(e){t._init_config_status()},function(){})},t.create_first=function(e){a.show({controller:CreateFirstController,templateUrl:"templates/dialog/create-first.tmpl.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0}).then(function(e){t._init_config_status()},function(){})},t.restart_ppmessage=function(t){a.show({controller:RestartController,templateUrl:"templates/dialog/restart-ppmessage.tmpl.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0}).then(function(t){n(function(){o.location.reload(),console.log("reload....")},2e3)},function(){})},t._init_config_status=function(){i.status().then(function(e){e=e.data,t._config_status.status=r[e.status],t._config_status.ip=e.ip},function(){})},t._init_config_status()}]),angular.element(document).ready(function(){angular.bootstrap(document,["this_app"])});